# Домашняя работа №7 (к занятию от 04.09.23)
[Блокировки]

- [x] Использую ранее созданный инстанс виртуальной машины "postgres2" с дефолтными параметрами в YC (ОС:Ubuntu 22.04, HDD 10Gb, RAM 4Gb);
- [x] Добавлен ssh ключ в metadata ВМ yc_key.pub;
- [x] Развернут кластер БД PostgreSQL 15;

`silunsky@postgres:~$ pg_lsclusters`

`Ver Cluster Port Status Owner    Data directory              Log file`

`15  main    5432 online postgres /var/lib/postgresql/15/main /var/log/postgresql/postgresql-15-main.log`

- [x] Настроим сервер так, чтобы в журнал сообщений сбрасывалась информация о блокировках, удерживаемых более 200 миллисекунд;

Для этого включим параметр `log_lock_waits`

`postgres@postgres2:~$ psql`

psql (15.4 (Ubuntu 15.4-1.pgdg22.04+1))

Type "help" for help.

`postgres=# SHOW deadlock_timeout;`

| deadlock_timeout |
|------------------|
| 1s               |
(1 row)

`postgres=# SHOW log_lock_waits;`

| log_lock_waits  | 
|---------------- |
| off             |
(1 row)

`postgres=# ALTER SYSTEM SET log_lock_waits = on;`

ALTER SYSTEM

`postgres=# SELECT pg_reload_conf();`

| pg_reload_conf  | 
|---------------- |
| t               |
(1 row)

`postgres=# SHOW log_lock_waits;`

| log_lock_waits  | 
|---------------- |
| on              |
(1 row)


